<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stats vs Scouts - Basketball Decision Lab</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  :root {
    --bg: #0f1628;
    --card: #171e33;
    --accent: #5b8aff;
    --accent2: #ff7a5c;
    --green: #3ee0a5;
    --gold: #ffc844;
    --text: #e8ecf4;
    --muted: #99a4bd;
    --border: #283050;
  }

  body {
    font-family: 'Inter', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* ── Fun animated background ── */
  .bg-anim {
    position: fixed; inset: 0; z-index: 0; pointer-events: none;
    background:
      radial-gradient(ellipse 90% 60% at 50% -10%, rgba(91,138,255,.18), transparent),
      radial-gradient(ellipse 70% 50% at 80% 110%, rgba(255,122,92,.10), transparent),
      radial-gradient(ellipse 50% 40% at 10% 80%, rgba(62,224,165,.08), transparent);
  }

  .container { max-width: 1000px; margin: 0 auto; padding: 1.25rem; position: relative; z-index: 1; }

  /* ── Header ── */
  header { text-align: center; padding: 1.5rem 0 .75rem; }
  header h1 {
    font-size: 2.2rem; font-weight: 900;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    letter-spacing: -1px;
  }
  header p { color: var(--muted); margin-top: .35rem; font-size: 1.05rem; }

  /* ── Progress bar ── */
  .progress-wrap {
    display: flex; align-items: center; gap: .75rem;
    background: var(--card); border: 1px solid var(--border);
    border-radius: 999px; padding: .55rem 1.2rem; margin: 1.25rem auto; max-width: 520px;
  }
  .progress-wrap span { font-size: .85rem; color: var(--muted); white-space: nowrap; font-weight: 700; }
  .progress-bar { flex: 1; height: 10px; background: var(--border); border-radius: 999px; overflow: hidden; }
  .progress-fill { height: 100%; width: 0%; background: linear-gradient(90deg, var(--accent), var(--green)); border-radius: 999px; transition: width .6s ease; }

  /* ── Screens ── */
  .screen { display: none; animation: fadeUp .5s ease; }
  .screen.active { display: block; }
  @keyframes fadeUp { from { opacity: 0; transform: translateY(18px); } to { opacity: 1; transform: translateY(0); } }

  /* ── Intro ── */
  .intro-box {
    text-align: center; padding: 2.5rem 2rem;
    background: var(--card); border: 1px solid var(--border); border-radius: 1.2rem;
    max-width: 660px; margin: 1.5rem auto;
  }
  .intro-box .big-emoji { font-size: 4rem; margin-bottom: .75rem; }
  .intro-box h2 { font-size: 1.7rem; margin-bottom: .75rem; }
  .intro-box p { color: var(--muted); line-height: 1.8; margin-bottom: 1.2rem; font-size: 1.05rem; }
  .intro-box .highlight { color: var(--text); font-weight: 700; }

  /* ── Buttons ── */
  .btn {
    display: inline-flex; align-items: center; gap: .5rem;
    padding: .9rem 2.2rem; border: none; border-radius: .7rem;
    font-family: inherit; font-weight: 800; font-size: 1.05rem;
    cursor: pointer; transition: all .2s;
  }
  .btn-primary { background: var(--accent); color: #fff; }
  .btn-primary:hover { background: #4a78e8; transform: translateY(-2px); box-shadow: 0 6px 20px rgba(91,138,255,.35); }
  .btn-gold { background: linear-gradient(135deg, var(--gold), #f5a623); color: #1a1a2e; }
  .btn-gold:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(255,200,68,.35); }
  .btn:disabled { opacity: .35; cursor: not-allowed; transform: none !important; box-shadow: none !important; }

  /* ── Stage header ── */
  .stage-header { text-align: center; margin-bottom: 1.5rem; }
  .stage-label {
    display: inline-block; background: var(--accent); color: #fff; font-size: .75rem;
    font-weight: 800; padding: .35rem .9rem; border-radius: 999px; text-transform: uppercase;
    letter-spacing: 1px; margin-bottom: .5rem;
  }
  .stage-header h2 { font-size: 1.6rem; font-weight: 800; }
  .stage-header p { color: var(--muted); margin-top: .3rem; font-size: 1rem; }

  /* ── Help box ── */
  .help-box {
    background: rgba(91,138,255,.08); border: 1px solid rgba(91,138,255,.22);
    border-radius: .9rem; padding: 1.1rem 1.5rem; margin-bottom: 1.75rem;
    font-size: .95rem; color: var(--muted); line-height: 1.7; text-align: center;
  }
  .help-box strong { color: var(--text); }

  /* ── Glossary tooltip ── */
  .glossary {
    display: inline-block; position: relative; border-bottom: 1px dashed var(--accent);
    cursor: help; color: var(--accent); font-weight: 600;
  }
  .glossary .tip {
    display: none; position: absolute; bottom: 130%; left: 50%; transform: translateX(-50%);
    background: #222b48; color: var(--text); padding: .6rem .9rem; border-radius: .5rem;
    font-size: .78rem; font-weight: 500; width: 220px; text-align: center;
    box-shadow: 0 6px 20px rgba(0,0,0,.4); z-index: 10; line-height: 1.4;
  }
  .glossary:hover .tip { display: block; }

  /* ── Player card ── */
  .player-card {
    background: var(--card); border: 2px solid var(--border); border-radius: 1rem;
    margin-bottom: 1.75rem; overflow: hidden; transition: border-color .3s;
  }
  .player-card:hover { border-color: #3d4f78; }
  .player-card-head {
    display: flex; align-items: center; gap: 1rem;
    padding: 1.1rem 1.4rem; border-bottom: 1px solid var(--border);
    background: rgba(255,255,255,.02);
  }
  .player-avatar {
    width: 58px; height: 58px; border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 1.5rem; font-weight: 900; color: #fff; flex-shrink: 0;
  }
  .player-info h3 { font-size: 1.15rem; font-weight: 800; }
  .player-info .team-pos { font-size: .85rem; color: var(--muted); }

  .card-columns { display: grid; grid-template-columns: 1fr 1fr; }
  .card-col { padding: 1.1rem 1.4rem; }
  .card-col:first-child { border-right: 1px solid var(--border); }
  .card-col-label {
    font-size: .72rem; font-weight: 800; text-transform: uppercase;
    letter-spacing: 1.5px; margin-bottom: .7rem; display: flex; align-items: center; gap: .4rem;
  }
  .label-scout { color: #c89aff; }
  .label-stat { color: #5cc8f5; }
  .card-col p { font-size: .92rem; color: var(--muted); line-height: 1.65; }

  .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: .5rem; }
  .stat-item {
    background: rgba(255,255,255,.04); border-radius: .5rem; padding: .55rem .7rem;
  }
  .stat-item .stat-val { font-size: 1.1rem; font-weight: 900; color: var(--text); }
  .stat-item .stat-label { font-size: .68rem; color: var(--muted); text-transform: uppercase; letter-spacing: .5px; }

  /* ── Choice buttons ── */
  .choice-row {
    display: flex; gap: .75rem; padding: 1rem 1.4rem; border-top: 1px solid var(--border);
    flex-wrap: wrap;
  }
  .choice-btn {
    flex: 1; min-width: 100px; padding: .75rem .5rem; border: 2px solid var(--border);
    background: transparent; border-radius: .6rem; color: var(--text);
    font-family: inherit; font-weight: 700; font-size: .9rem; cursor: pointer; transition: all .2s;
  }
  .choice-btn:hover { border-color: var(--accent); background: rgba(91,138,255,.08); }
  .choice-btn.selected { border-color: var(--accent); background: rgba(91,138,255,.15); color: #fff; }
  .choice-btn.correct { border-color: var(--green); background: rgba(62,224,165,.12); color: var(--green); }
  .choice-btn.wrong { border-color: var(--accent2); background: rgba(255,122,92,.12); color: var(--accent2); }
  .choice-btn:disabled { cursor: default; }

  /* ── Reveal bar ── */
  .reveal-bar {
    display: none; padding: 1.1rem 1.4rem; border-top: 1px solid var(--border);
    background: rgba(255,255,255,.02); animation: fadeUp .4s ease;
  }
  .reveal-bar.show { display: flex; align-items: flex-start; gap: .9rem; }
  .reveal-icon { font-size: 1.6rem; flex-shrink: 0; margin-top: 2px; }
  .reveal-text h4 { font-size: 1rem; font-weight: 800; margin-bottom: .3rem; }
  .reveal-text p { font-size: .9rem; color: var(--muted); line-height: 1.6; }

  /* ── Fun fact badge ── */
  .fun-fact {
    margin-top: .6rem; padding: .5rem .8rem; background: rgba(255,200,68,.08);
    border: 1px solid rgba(255,200,68,.18); border-radius: .5rem;
    font-size: .82rem; color: var(--gold); line-height: 1.5;
  }

  /* ── Stage 2 sign cards ── */
  .sign-cards { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem; }
  @media (max-width: 700px) {
    .sign-cards { grid-template-columns: 1fr; }
    .card-columns { grid-template-columns: 1fr; }
    .card-col:first-child { border-right: none; border-bottom: 1px solid var(--border); }
  }

  .sign-card {
    background: var(--card); border: 2px solid var(--border); border-radius: 1rem;
    overflow: hidden; cursor: pointer; transition: all .3s; position: relative;
  }
  .sign-card:hover { border-color: #3d4f78; transform: translateY(-3px); box-shadow: 0 8px 28px rgba(0,0,0,.3); }
  .sign-card.selected-sign { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(91,138,255,.22); }
  .sign-card.correct-sign { border-color: var(--green); box-shadow: 0 0 0 3px rgba(62,224,165,.22); }
  .sign-card.wrong-sign { border-color: var(--accent2); box-shadow: 0 0 0 3px rgba(255,122,92,.22); }

  .sign-card-head {
    padding: 1.4rem; text-align: center; border-bottom: 1px solid var(--border);
  }
  .sign-card-head .player-avatar { margin: 0 auto .7rem; width: 72px; height: 72px; font-size: 1.9rem; }
  .sign-card-head h3 { font-size: 1.2rem; font-weight: 900; }
  .sign-card-head .team-pos { color: var(--muted); font-size: .85rem; }
  .sign-card-body { padding: 1.2rem 1.4rem; }
  .sign-card-body h4 {
    font-size: .72rem; font-weight: 800; text-transform: uppercase;
    letter-spacing: 1.5px; color: var(--muted); margin-bottom: .6rem;
  }
  .sign-card-body p { font-size: .9rem; color: var(--muted); line-height: 1.65; margin-bottom: 1rem; }

  .contract-tag {
    display: inline-block; padding: .45rem .9rem; border-radius: .5rem;
    font-weight: 800; font-size: .9rem; margin-bottom: .4rem;
  }
  .contract-blue { background: rgba(91,138,255,.15); color: var(--accent); }
  .contract-green { background: rgba(62,224,165,.15); color: var(--green); }

  .mini-stat {
    display: flex; justify-content: space-between; padding: .4rem 0;
    border-bottom: 1px solid var(--border); font-size: .88rem;
  }
  .mini-stat:last-child { border-bottom: none; }
  .mini-stat .ms-label { color: var(--muted); }
  .mini-stat .ms-val { font-weight: 800; }

  .sign-badge {
    position: absolute; top: .8rem; right: .8rem; padding: .3rem .75rem;
    border-radius: 999px; font-size: .72rem; font-weight: 800;
    text-transform: uppercase; letter-spacing: .5px; display: none;
  }
  .sign-card.correct-sign .sign-badge { display: block; background: var(--green); color: #000; }
  .sign-card.wrong-sign .sign-badge { display: block; background: var(--accent2); color: #fff; }

  /* ── Stage 2 explanation reveal ── */
  .s2-reveal {
    display: none; background: var(--card); border: 1px solid var(--border);
    border-radius: 1rem; padding: 1.4rem 1.6rem; margin-bottom: 1.5rem;
    animation: fadeUp .4s ease;
  }
  .s2-reveal.show { display: block; }
  .s2-reveal h4 { font-size: 1rem; font-weight: 800; margin-bottom: .4rem; }
  .s2-reveal p { font-size: .92rem; color: var(--muted); line-height: 1.65; }

  /* ── Timer bar ── */
  .timer-bar-wrap {
    max-width: 520px; margin: 0 auto 1.5rem; display: flex; align-items: center; gap: .75rem;
  }
  .timer-bar-wrap .timer-label { font-size: .85rem; color: var(--muted); font-weight: 700; white-space: nowrap; }
  .timer-track { flex: 1; height: 8px; background: var(--border); border-radius: 999px; overflow: hidden; }
  .timer-fill { height: 100%; background: var(--gold); border-radius: 999px; transition: width .25s linear; width: 100%; }
  .timer-fill.danger { background: var(--accent2); }

  /* ── Results ── */
  .results-box {
    text-align: center; padding: 2.5rem 2rem;
    background: var(--card); border: 1px solid var(--border); border-radius: 1.2rem;
    max-width: 660px; margin: 1.5rem auto;
  }
  .results-box .big-emoji { font-size: 4rem; margin-bottom: .5rem; }
  .results-box h2 { font-size: 1.8rem; margin-bottom: .5rem; }
  .score-big {
    font-size: 3.5rem; font-weight: 900;
    background: linear-gradient(135deg, var(--accent), var(--green));
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    margin: .75rem 0;
  }
  .score-breakdown { display: flex; justify-content: center; gap: 2.5rem; margin: 1.25rem 0; }
  .score-part { text-align: center; }
  .score-part .sp-num { font-size: 1.6rem; font-weight: 900; }
  .score-part .sp-label { font-size: .78rem; color: var(--muted); text-transform: uppercase; letter-spacing: .5px; }
  .verdict {
    background: rgba(255,255,255,.04); border-radius: .8rem; padding: 1.3rem;
    margin-top: 1.25rem; max-width: 500px; margin-left: auto; margin-right: auto;
  }
  .verdict h4 { margin-bottom: .4rem; font-size: 1.05rem; }
  .verdict p { color: var(--muted); font-size: .92rem; line-height: 1.65; }

  .action-footer { text-align: center; margin: 1.75rem 0; }

  /* ── Confetti canvas ── */
  #confetti { position: fixed; inset: 0; z-index: 100; pointer-events: none; }
</style>
</head>
<body>
<div class="bg-anim"></div>
<canvas id="confetti"></canvas>
<div class="container">

  <header>
    <h1>Stats vs Scouts</h1>
    <p>The Basketball Decision Lab</p>
  </header>

  <div class="progress-wrap">
    <span id="progLabel">0 / 4</span>
    <div class="progress-bar"><div class="progress-fill" id="progFill"></div></div>
    <span id="scoreLabel">Score: 0</span>
  </div>

  <!-- ═══════ INTRO ═══════ -->
  <div class="screen active" id="introScreen">
    <div class="intro-box">
      <div class="big-emoji">&#127936;</div>
      <h2>Hey There, Future GM!</h2>
      <p>
        Imagine you just got hired to run an NBA team. Cool, right?<br><br>
        Your team has two ways to judge players:<br>
        <span class="highlight">Scouts</span> &mdash; people who watch games and share their opinions.<br>
        <span class="highlight">Stats</span> &mdash; numbers that show how a player actually performed.<br><br>
        Sometimes they agree. Sometimes they don't!<br>
        Your job is to figure out <span class="highlight">who got it right</span>.
      </p>
      <button class="btn btn-primary" onclick="startGame()">Let's Go!</button>
    </div>
  </div>

  <!-- ═══════ STAGE 1 ═══════ -->
  <div class="screen" id="stage1Screen">
    <div class="stage-header">
      <span class="stage-label">Round 1</span>
      <h2>Who Got It Right?</h2>
      <p>Read what the scouts said and look at the stats. Then pick who was more right!</p>
    </div>

    <div class="help-box">
      <strong>Quick guide:</strong> The <strong>left side</strong> shows what scouts said about each player before seeing them play much.
      The <strong>right side</strong> shows what the <strong>numbers</strong> actually say.
      Pick who told the real story &mdash; the <strong>Scouts</strong>, the <strong>Stats</strong>, or <strong>Both</strong>!
      <br><em>(Hover or tap the blue words on stat cards to learn what they mean!)</em>
    </div>

    <div id="stage1Cards"></div>

    <div class="action-footer">
      <button class="btn btn-primary" id="stage1Next" disabled onclick="goToStage2()">On to Round 2!</button>
    </div>
  </div>

  <!-- ═══════ STAGE 2 ═══════ -->
  <div class="screen" id="stage2Screen">
    <div class="stage-header">
      <span class="stage-label" style="background:var(--accent2)">Round 2</span>
      <h2>Who Should You Sign?</h2>
      <p>Time to make a real decision! Pick the player who's the better deal for your team.</p>
    </div>

    <div class="help-box">
      <strong>The situation:</strong> Your team has money to sign <strong>one</strong> new player.
      Look at what the scouts say, what the numbers show, AND how much each player costs.
      Who gives your team the <strong>best bang for your buck</strong>?
    </div>

    <div class="timer-bar-wrap" id="timerWrap" style="display:none;">
      <span class="timer-label" id="timerText">45s</span>
      <div class="timer-track"><div class="timer-fill" id="timerFill"></div></div>
    </div>

    <div class="sign-cards" id="stage2Cards"></div>

    <div id="s2RevealBox" class="s2-reveal">
      <h4 id="s2RevealTitle"></h4>
      <p id="s2RevealText"></p>
    </div>

    <div class="action-footer">
      <button class="btn btn-gold" id="stage2Confirm" disabled onclick="confirmSign()">Lock In My Pick!</button>
    </div>
  </div>

  <!-- ═══════ RESULTS ═══════ -->
  <div class="screen" id="resultsScreen">
    <div class="results-box">
      <div class="big-emoji" id="resultsEmoji">&#127942;</div>
      <h2>Great Job!</h2>
      <div class="score-big" id="finalScore">0 / 4</div>
      <div class="score-breakdown">
        <div class="score-part">
          <div class="sp-num" id="s1Score">0/3</div>
          <div class="sp-label">Round 1</div>
        </div>
        <div class="score-part">
          <div class="sp-num" id="s2Score">0/1</div>
          <div class="sp-label">Round 2</div>
        </div>
      </div>
      <div class="verdict" id="verdictBox">
        <h4 id="verdictTitle"></h4>
        <p id="verdictText"></p>
      </div>
      <br>
      <button class="btn btn-primary" onclick="location.reload()">Play Again</button>
    </div>
  </div>

</div>

<script>
// ═══════════════════════════════════════════
//  GLOSSARY — kid-friendly stat definitions
// ═══════════════════════════════════════════
const glossary = {
  "PPG":       "Points Per Game &mdash; how many points they score each game on average.",
  "RPG":       "Rebounds Per Game &mdash; how often they grab the ball after a missed shot.",
  "APG":       "Assists Per Game &mdash; how many times they pass to a teammate who scores.",
  "SPG":       "Steals Per Game &mdash; how often they take the ball from the other team.",
  "BPG":       "Blocks Per Game &mdash; how often they swat away the other team's shots.",
  "FG%":       "Field Goal % &mdash; what percentage of their shots go in. Higher = better shooter.",
  "3PT%":      "3-Point % &mdash; what percentage of their 3-point shots go in.",
  "+/-":       "Plus/Minus &mdash; does the team score more or get scored on more when this player is on the court? Positive is good!",
  "TO/G":      "Turnovers Per Game &mdash; how often they lose the ball. Lower is better!",
  "MPG":       "Minutes Per Game &mdash; how many minutes per game the coach puts them in.",
};

function glossWrap(label) {
  const tip = glossary[label];
  if (!tip) return label;
  return `<span class="glossary">${label}<span class="tip">${tip}</span></span>`;
}

// ═══════════════════════════════════════════
//  REAL NBA PLAYER DATA  (kid-friendly stats)
// ═══════════════════════════════════════════

const stage1Players = [
  {
    name: "Andrew Wiggins",
    team: "Minnesota Timberwolves (2015-20)",
    pos: "Small Forward",
    color: "#1d428a",
    initials: "AW",
    scout: "Super athletic &mdash; can jump out of the gym! Smooth jump shot and can score from anywhere. Scouts thought he'd be a future superstar and the next big thing.",
    stats: [
      { label: "PPG", val: "22.4" },
      { label: "FG%", val: "44%" },
      { label: "3PT%", val: "33%" },
      { label: "RPG", val: "4.3" },
      { label: "TO/G", val: "2.3" },
      { label: "+/-", val: "-4.2" }
    ],
    answer: "stats",
    revealTitle: "The Stats were more right!",
    revealText: "Scouts loved how athletic Wiggins looked, but the numbers told a different story. He only made 44% of his shots, turned the ball over a lot, and his team actually did worse when he was on the court (-4.2). He didn't become a real winner until he joined Golden State and changed his role.",
    funFact: "Fun fact: Wiggins was the #1 pick in the 2014 NBA Draft!"
  },
  {
    name: "Draymond Green",
    team: "Golden State Warriors (2015-20)",
    pos: "Power Forward",
    color: "#006bb6",
    initials: "DG",
    scout: "Too short for his position. Can't really score. Doesn't have a go-to move on offense. Scouts thought he was a backup player at best &mdash; he was picked in the 2nd round!",
    stats: [
      { label: "PPG", val: "11.3" },
      { label: "APG", val: "7.0" },
      { label: "RPG", val: "8.2" },
      { label: "SPG", val: "1.4" },
      { label: "BPG", val: "1.3" },
      { label: "+/-", val: "+7.8" }
    ],
    answer: "stats",
    revealTitle: "The Stats were more right!",
    revealText: "Scouts thought Draymond was too small and couldn't score enough. But the numbers showed he did everything else amazingly &mdash; 7 assists, 8 rebounds, and his team scored way more with him on the court (+7.8)! He won Defensive Player of the Year and helped the Warriors win championships.",
    funFact: "Fun fact: Draymond was picked 35th in the draft &mdash; and became a 4x champion!"
  },
  {
    name: "Luka Doncic",
    team: "Dallas Mavericks (2019-23)",
    pos: "Point Guard",
    color: "#00538c",
    initials: "LD",
    scout: "Incredible basketball brain &mdash; always knows the right play. Amazing passer and scorer. BUT scouts also worried he might not be fast enough to guard NBA players and could be lazy on defense.",
    stats: [
      { label: "PPG", val: "28.7" },
      { label: "APG", val: "8.7" },
      { label: "RPG", val: "8.8" },
      { label: "FG%", val: "46%" },
      { label: "3PT%", val: "35%" },
      { label: "+/-", val: "+3.1" }
    ],
    answer: "both",
    revealTitle: "Both were right!",
    revealText: "The scouts were right that Luka is an offensive genius &mdash; almost 29 points, 9 assists, and 9 rebounds a game is incredible! But they were also right about his defense being a weak spot. The stats confirmed both things. Sometimes both sides of the story are true!",
    funFact: "Fun fact: Luka won a professional championship in Europe when he was only 16 years old!"
  }
];

const stage2Players = [
  {
    name: "Zach LaVine",
    team: "Chicago Bulls",
    pos: "Shooting Guard",
    color: "#ce1141",
    initials: "ZL",
    contract: "$21 million / year",
    contractClass: "contract-blue",
    scout: "Amazing dunker and super exciting to watch. Can score a ton of points and hit big shots. But he gets hurt a lot and doesn't play great defense.",
    statLines: [
      { label: "PPG", val: "24.8" },
      { label: "FG%", val: "48%" },
      { label: "3PT%", val: "38%" },
      { label: "RPG", val: "4.6" },
      { label: "APG", val: "4.5" },
      { label: "+/-", val: "-1.3" }
    ]
  },
  {
    name: "Mikal Bridges",
    team: "Phoenix / Brooklyn",
    pos: "Small Forward",
    color: "#1d1160",
    initials: "MB",
    contract: "$13 million / year",
    contractClass: "contract-green",
    scout: "Does everything well &mdash; great defender, smart player, good shooter. Doesn't make highlight reels but makes every team he's on better. Almost never misses a game!",
    statLines: [
      { label: "PPG", val: "14.8" },
      { label: "FG%", val: "49%" },
      { label: "3PT%", val: "37%" },
      { label: "SPG", val: "1.1" },
      { label: "BPG", val: "0.6" },
      { label: "+/-", val: "+4.2" }
    ]
  }
];

const stage2Answer = 1; // Mikal Bridges = better value
const stage2RevealTitle = "Best pick: Mikal Bridges!";
const stage2RevealText = "Even though LaVine scores more, Bridges costs $8 million less per year, plays amazing defense, almost never gets hurt, and his teams actually score MORE with him on the court (+4.2 vs -1.3). That's way more value for your money! A smart GM thinks about the whole picture &mdash; not just points.";

// ═══════════════════════════════════════════
//  GAME STATE
// ═══════════════════════════════════════════
let s1Answers = [null, null, null];
let s1Locked  = [false, false, false];
let s2Choice  = null;
let s2Locked  = false;
let score     = 0;
let totalQ    = 4;
let answered  = 0;
let timerInterval = null;

// ═══════════════════════════════════════════
//  RENDER
// ═══════════════════════════════════════════

function renderStage1() {
  const wrap = document.getElementById('stage1Cards');
  wrap.innerHTML = '';
  stage1Players.forEach((p, i) => {
    const card = document.createElement('div');
    card.className = 'player-card';
    card.innerHTML = `
      <div class="player-card-head">
        <div class="player-avatar" style="background:${p.color}">${p.initials}</div>
        <div class="player-info">
          <h3>${p.name}</h3>
          <span class="team-pos">${p.team} &bull; ${p.pos}</span>
        </div>
      </div>
      <div class="card-columns">
        <div class="card-col">
          <div class="card-col-label label-scout">&#128064; What Scouts Said</div>
          <p>${p.scout}</p>
        </div>
        <div class="card-col">
          <div class="card-col-label label-stat">&#128202; What the Numbers Say</div>
          <div class="stat-grid">
            ${p.stats.map(s => `<div class="stat-item"><div class="stat-val">${s.val}</div><div class="stat-label">${glossWrap(s.label)}</div></div>`).join('')}
          </div>
        </div>
      </div>
      <div class="choice-row" id="choices${i}">
        <button class="choice-btn" data-val="scouts" onclick="pickS1(${i},'scouts',this)">&#128064; Scouts Were Right</button>
        <button class="choice-btn" data-val="stats" onclick="pickS1(${i},'stats',this)">&#128202; Stats Were Right</button>
        <button class="choice-btn" data-val="both" onclick="pickS1(${i},'both',this)">&#129309; Both Were Right</button>
      </div>
      <div class="reveal-bar" id="reveal${i}">
        <div class="reveal-icon" id="revealIcon${i}"></div>
        <div class="reveal-text">
          <h4 id="revealTitle${i}"></h4>
          <p id="revealText${i}"></p>
          <div class="fun-fact" id="funFact${i}"></div>
        </div>
      </div>
    `;
    wrap.appendChild(card);
  });
}

function renderStage2() {
  const wrap = document.getElementById('stage2Cards');
  wrap.innerHTML = '';
  stage2Players.forEach((p, i) => {
    const card = document.createElement('div');
    card.className = 'sign-card';
    card.id = `s2card${i}`;
    card.onclick = () => pickS2(i);
    card.innerHTML = `
      <span class="sign-badge" id="s2badge${i}"></span>
      <div class="sign-card-head">
        <div class="player-avatar" style="background:${p.color}">${p.initials}</div>
        <h3>${p.name}</h3>
        <div class="team-pos">${p.team} &bull; ${p.pos}</div>
        <div class="contract-tag ${p.contractClass}" style="margin-top:.7rem">${p.contract}</div>
      </div>
      <div class="sign-card-body">
        <h4>&#128064; What Scouts Say</h4>
        <p>${p.scout}</p>
        <h4>&#128202; Key Numbers</h4>
        ${p.statLines.map(s => `<div class="mini-stat"><span class="ms-label">${glossWrap(s.label)}</span><span class="ms-val">${s.val}</span></div>`).join('')}
      </div>
    `;
    wrap.appendChild(card);
  });
}

// ═══════════════════════════════════════════
//  GAME LOGIC
// ═══════════════════════════════════════════

function startGame() {
  show('stage1Screen');
  renderStage1();
  updateProgress();
}

function pickS1(idx, val, btn) {
  if (s1Locked[idx]) return;
  const row = document.getElementById(`choices${idx}`);
  row.querySelectorAll('.choice-btn').forEach(b => b.classList.remove('selected'));
  btn.classList.add('selected');
  s1Answers[idx] = val;

  s1Locked[idx] = true;
  const correct = stage1Players[idx].answer;
  const isCorrect = val === correct;

  row.querySelectorAll('.choice-btn').forEach(b => {
    b.disabled = true;
    if (b.dataset.val === correct) b.classList.add('correct');
    if (b.dataset.val === val && !isCorrect) b.classList.add('wrong');
  });

  if (isCorrect) score++;
  answered++;

  const rev = document.getElementById(`reveal${idx}`);
  rev.classList.add('show');
  document.getElementById(`revealIcon${idx}`).textContent = isCorrect ? '\u2705' : '\u274C';
  document.getElementById(`revealTitle${idx}`).textContent = stage1Players[idx].revealTitle;
  document.getElementById(`revealText${idx}`).textContent = stage1Players[idx].revealText;
  document.getElementById(`funFact${idx}`).textContent = stage1Players[idx].funFact;

  updateProgress();

  if (s1Locked.every(Boolean)) {
    document.getElementById('stage1Next').disabled = false;
    document.getElementById('stage1Next').scrollIntoView({ behavior: 'smooth', block: 'center' });
  }
}

function goToStage2() {
  show('stage2Screen');
  renderStage2();
  startTimer(45);
}

function pickS2(idx) {
  if (s2Locked) return;
  s2Choice = idx;
  document.querySelectorAll('.sign-card').forEach((c, i) => {
    c.classList.toggle('selected-sign', i === idx);
  });
  document.getElementById('stage2Confirm').disabled = false;
}

function confirmSign() {
  if (s2Locked || s2Choice === null) return;
  s2Locked = true;
  clearInterval(timerInterval);

  const isCorrect = s2Choice === stage2Answer;
  if (isCorrect) score++;
  answered++;

  document.querySelectorAll('.sign-card').forEach((c, i) => {
    c.classList.remove('selected-sign');
    c.onclick = null;
    c.style.cursor = 'default';
    if (i === stage2Answer) {
      c.classList.add('correct-sign');
      document.getElementById(`s2badge${i}`).textContent = 'Best Deal';
    }
    if (i === s2Choice && !isCorrect) {
      c.classList.add('wrong-sign');
      document.getElementById(`s2badge${i}`).textContent = 'Your Pick';
    }
  });
  document.getElementById('stage2Confirm').disabled = true;

  // Show explanation
  const box = document.getElementById('s2RevealBox');
  document.getElementById('s2RevealTitle').textContent = (isCorrect ? '\u2705 ' : '\u274C ') + stage2RevealTitle;
  document.getElementById('s2RevealText').textContent = stage2RevealText;
  box.classList.add('show');

  updateProgress();
  setTimeout(showResults, 2500);
}

function startTimer(seconds) {
  const wrap = document.getElementById('timerWrap');
  const fill = document.getElementById('timerFill');
  const text = document.getElementById('timerText');
  wrap.style.display = 'flex';
  let remaining = seconds;
  fill.style.width = '100%';
  fill.classList.remove('danger');
  text.textContent = remaining + 's';

  timerInterval = setInterval(() => {
    remaining--;
    if (remaining <= 0) {
      clearInterval(timerInterval);
      remaining = 0;
      if (!s2Locked) {
        if (s2Choice === null) {
          s2Choice = 1 - stage2Answer;
          document.querySelectorAll('.sign-card')[s2Choice].classList.add('selected-sign');
        }
        confirmSign();
      }
    }
    const pct = (remaining / seconds) * 100;
    fill.style.width = pct + '%';
    if (pct < 25) fill.classList.add('danger');
    text.textContent = remaining + 's';
  }, 1000);
}

function showResults() {
  show('resultsScreen');
  const s1 = s1Locked.reduce((acc, _, i) => acc + (s1Answers[i] === stage1Players[i].answer ? 1 : 0), 0);
  const s2 = (s2Choice === stage2Answer) ? 1 : 0;
  document.getElementById('finalScore').textContent = score + ' / ' + totalQ;
  document.getElementById('s1Score').textContent = s1 + '/3';
  document.getElementById('s2Score').textContent = s2 + '/1';

  let title, text, emoji;
  if (score === 4) {
    title = "All-Star GM!";
    text = "You nailed every question! You know how to use both scouting reports AND stats to make smart decisions. NBA teams would be lucky to have you!";
    emoji = "\u{1F3C6}";
    launchConfetti();
  } else if (score === 3) {
    title = "Solid Team Builder!";
    text = "Great job! You understand that sometimes scouts are right, sometimes the numbers are right, and sometimes both tell part of the story. Keep it up!";
    emoji = "\u{1F31F}";
    launchConfetti();
  } else if (score === 2) {
    title = "Good Start, Rookie!";
    text = "Not bad for your first try! The biggest lesson: don't just look at one thing. Smart GMs use BOTH what people say AND what the numbers show.";
    emoji = "\u{1F4AA}";
  } else {
    title = "Keep Learning!";
    text = "Player evaluation is tricky &mdash; even real NBA teams get it wrong sometimes! The key is to always look at the full picture: what scouts see AND what the stats say.";
    emoji = "\u{1F4DA}";
  }
  document.getElementById('resultsEmoji').textContent = emoji;
  document.getElementById('verdictTitle').textContent = title;
  document.getElementById('verdictText').innerHTML = text;
}

// ═══════════════════════════════════════════
//  CONFETTI  (fun reward for good scores)
// ═══════════════════════════════════════════

function launchConfetti() {
  const canvas = document.getElementById('confetti');
  const ctx = canvas.getContext('2d');
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  const colors = ['#5b8aff','#ff7a5c','#3ee0a5','#ffc844','#c89aff','#5cc8f5'];
  const pieces = [];
  for (let i = 0; i < 120; i++) {
    pieces.push({
      x: Math.random() * canvas.width,
      y: Math.random() * canvas.height - canvas.height,
      r: Math.random() * 6 + 4,
      d: Math.random() * 80 + 40,
      color: colors[Math.floor(Math.random() * colors.length)],
      tilt: Math.random() * 10 - 5,
      tiltAngle: Math.random() * Math.PI,
      tiltSpeed: Math.random() * 0.1 + 0.05
    });
  }

  let frame = 0;
  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    pieces.forEach(p => {
      ctx.beginPath();
      ctx.fillStyle = p.color;
      ctx.globalAlpha = Math.max(0, 1 - frame / 120);
      ctx.fillRect(p.x + p.tilt, p.y, p.r, p.r * 1.5);
      p.y += 2.5 + p.r / 3;
      p.tiltAngle += p.tiltSpeed;
      p.tilt = Math.sin(p.tiltAngle) * 12;
    });
    frame++;
    if (frame < 140) requestAnimationFrame(draw);
    else ctx.clearRect(0, 0, canvas.width, canvas.height);
  }
  draw();
}

// ═══════════════════════════════════════════
//  UTILITIES
// ═══════════════════════════════════════════

function show(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function updateProgress() {
  const pct = (answered / totalQ) * 100;
  document.getElementById('progFill').style.width = pct + '%';
  document.getElementById('progLabel').textContent = answered + ' / ' + totalQ;
  document.getElementById('scoreLabel').textContent = 'Score: ' + score;
}
</script>
</body>
</html>
